<!DOCTYPE html>
<html>
<head >
    <meta charset="UTF-8">
    <title>图片延时加载2</title>
    <style type="text/css">
        *{
            margin:0;
            padding:0;
        }
        #box{
            width:300px;
            height:300px;
            margin:1000px auto;
            border:1px solid black;
            background: url("img/default.gif") no-repeat center center #cccccc;
        }
        #box img{
            display: none;
            width:100%;
            height:100%;
        }

    </style>
</head>
<body>

<div id="box">
    <img src="" trueImg="img/jd.jpg"/>
</div>

<script type="text/javascript" src="utils.js"> </script>
<script type="text/javascript">


    var oBody = document.getElementsByTagName("body")[0];
    var box = document.getElementById("box");
    var oImg = document.getElementsByTagName("img")[0];


    window.onscroll = function () {

        if(box.isLoad){
            return;
        }
        //获取到各个元素
        var a = box.offsetHeight + utils.offset(box).top;
        var b = utils.win("scrollTop")+utils.win("clientHeight");

        if(a<b){
            var img = new Image;
            img.src = oImg.getAttribute("trueImg");
            img.onload = function(){
                oImg.src=this.src;
                oImg.style.display = "block";
                img = null;

                console.log("ok");
            };
            box.isLoad = true;
        }


    }
</script>

</body>
</html>